---
title: "Ruan_Mathieu_Karim_PSET_4"
output: html_document
date: "2024-03-03"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r cars}
library(MASS)
library(biotools)
library(klaR)
library(car)
library(dplyr)
```

```{r}
eddata <- read.csv("Global_Education.csv") # (now with continents)
```

### Question 1
```{r}
GED_Leveled <- eddata |>
   mutate(ed_level = case_when(
    ((Completion_Rate_Upper_Secondary_Male + Completion_Rate_Upper_Secondary_Female) / 2) < 50 ~ "1",
    ((Completion_Rate_Upper_Secondary_Male + Completion_Rate_Upper_Secondary_Female) / 2) >= 50 &
    ((Completion_Rate_Upper_Secondary_Male + Completion_Rate_Upper_Secondary_Female) / 2) < 60 ~ "2",
    ((Completion_Rate_Upper_Secondary_Male + Completion_Rate_Upper_Secondary_Female) / 2) >= 60 ~ "3"
  )) |>
    select(ed_level, Birth_Rate, Unemployment_Rate, Continent)



interaction.plot(GED_Leveled$ed_level, GED_Leveled$Continent, GED_Leveled$Unemployment_Rate,
  lwd = 3, col = c("red", "blue", "black", "orange", "green"), trace.label = "Continent", 
  xlab = "Ed Level", main = "Interaction Plot for Unemployment Rate, Continent, Ed_Level")

interaction.plot(GED_Leveled$ed_level, GED_Leveled$Continent, GED_Leveled$Birth_Rate,
  lwd = 3, col = c("red", "blue", "black"), trace.label = "Continent ", 
  xlab = "Ed Level", main = "Interaction Plot for Unemployment Rate, Continent, Birth_Rate")



```

### Question 2
```{r}
options(contrasts = c("contr.sum", "contr.poly"))

DanielaMAOV <- lm(cbind(Birth_Rate, Unemployment_Rate) ~ Continent*ed_level,  
                data = GED_Leveled)

#Multivariate and univariate results
summary(Anova(DanielaMAOV, type = 2), univariate = F)
```

### Question 3
```{r}

#RUN LINE BELOW TO MAKE SURE CONTRASTS ARE SET CORRECTLY -  this returns things to their default level
options(contrasts = c("contr.treatment", "contr.poly"))

#Make sure TRTCOMB is a factor
daniela$TRTCOMB <- as.factor(daniela$TRTCOMB)

#Fit one way MANOVA model
DanielaMAOV2 <- lm(cbind(ASQRT, BSQRT, CSQRT) ~ TRTCOMB, data = daniela)
#Fit one way ANOVA model just for ASQRT
DanielaASQRT <- lm(ASQRT ~ TRTCOMB, data = daniela)

contrasts(daniela$TRTCOMB)
levels(daniela$TRTCOMB)

#Get multivariate contrast for P vs Q - notice that PCB is the reference level
linearHypothesis(DanielaMAOV2, "TRTCOMBPHA + TRTCOMBPTA + TRTCOMBPVF + TRTCOMBPVG + TRTCOMBPVK 
                 - TRTCOMBQCB - TRTCOMBQHA - TRTCOMBQTA - TRTCOMBQVF - TRTCOMBQVG - TRTCOMBQVK= 0") 

#Get univariate contrast for P vs Q for ASQRT
linearHypothesis(DanielaASQRT, "TRTCOMBPHA + TRTCOMBPTA + TRTCOMBPVF + TRTCOMBPVG + TRTCOMBPVK 
                 - TRTCOMBQCB - TRTCOMBQHA - TRTCOMBQTA - TRTCOMBQVF - TRTCOMBQVG - TRTCOMBQVK= 0") 

#Get multivariate contrast for P,Q and VF,VK interaction
linearHypothesis(DanielaMAOV2, "TRTCOMBPVF - TRTCOMBPVK - TRTCOMBQVF + TRTCOMBQVK = 0") 

#Get univariate contrast for P,Q and VF,VK interaction for ASQRT
linearHypothesis(DanielaASQRT, "TRTCOMBPVF - TRTCOMBPVK - TRTCOMBQVF + TRTCOMBQVK = 0") 
```

### Question 4
```{r}

```

### Question 5
```{r}
cqplot(sneetch[sneetch$Belly == "Star", c("wing","tail")], main = "Star")
```

### Question 6
```{r}
p.adjust(p = c(.0001, .6563, .0249), method = "bonferroni")

p.adjust(p = c(.0001, .6563, .0249), method = "holm")

p.adjust(p = c(.0001, .6563, .0249), method = "hochberg")
```
